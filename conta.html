<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - SuperMercado Online</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --success-color: #4CAF50;
            --danger-color: #ff4757;
            --warning-color: #ffa502;
            --info-color: #3742fa;
            --light-bg: #f8f9fa;
            --dark-text: #2c3e50;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
        }

        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 15px 0;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            text-decoration: none;
        }

        .back-btn {
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .checkout-header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .checkout-steps {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.3);
            font-weight: bold;
        }

        .step.active {
            background: var(--primary-color);
            color: white;
        }

        .step.completed {
            background: var(--success-color);
            color: white;
        }

        .checkout-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }

        .checkout-form {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .form-section {
            margin-bottom: 30px;
        }

        .form-section h3 {
            color: var(--dark-text);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-bg);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--dark-text);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .delivery-options {
            display: grid;
            gap: 15px;
        }

        .delivery-option {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .delivery-option:hover {
            border-color: var(--primary-color);
        }

        .delivery-option input[type="radio"] {
            margin-right: 10px;
        }

        .delivery-option.selected {
            border-color: var(--primary-color);
            background: rgba(102, 126, 234, 0.1);
        }

        .payment-methods {
            display: grid;
            gap: 15px;
        }

        .payment-method {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .payment-method:hover {
            border-color: var(--primary-color);
        }

        .payment-method.selected {
            border-color: var(--primary-color);
            background: rgba(102, 126, 234, 0.1);
        }

        .payment-icon {
            font-size: 2em;
        }

        .order-summary {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            height: fit-content;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--light-bg);
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .item-details {
            flex: 1;
        }

        .item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .item-quantity {
            color: #666;
            font-size: 14px;
        }

        .item-price {
            font-weight: bold;
            color: var(--primary-color);
        }

        .total-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid var(--primary-color);
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .total-final {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--primary-color);
        }

        .place-order-btn {
            width: 100%;
            background: linear-gradient(45deg, var(--success-color), #45a049);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .place-order-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .place-order-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* PIX Modal */
        .pix-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
            z-index: 2000;
        }

        .pix-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            text-align: center;
        }

        .pix-header {
            margin-bottom: 30px;
        }

        .qr-container {
            margin: 30px 0;
            padding: 20px;
            background: var(--light-bg);
            border-radius: 15px;
        }

        .qr-code {
            width: 250px;
            height: 250px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 15px;
        }

        .pix-info {
            background: #e8f4fd;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid var(--info-color);
        }

        .pix-key {
            background: var(--light-bg);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 14px;
            word-break: break-all;
            border: 1px solid #ddd;
        }

        .copy-btn {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 10px;
        }

        .copy-btn:hover {
            background: #45a049;
        }

        .payment-instructions {
            text-align: left;
            margin: 20px 0;
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #ddd;
        }

        .confirm-payment-btn {
            width: 100%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 3000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            font-weight: bold;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--success-color);
            color: white;
        }

        .notification.error {
            background: var(--danger-color);
            color: white;
        }

        @media (max-width: 768px) {
            .checkout-content {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .checkout-steps {
                flex-direction: column;
                align-items: center;
            }

            .container {
                padding: 20px 10px;
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.3/qrcode.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">üõí SuperMercado Online</a>
            <a href="index.html" class="back-btn">‚Üê Voltar √†s compras</a>
        </div>
    </nav>

    <div class="container">
        <div class="checkout-header">
            <h1>Finalizar Pedido</h1>
            <div class="checkout-steps">
                <div class="step active">
                    <span>1Ô∏è‚É£</span>
                    <span>Dados</span>
                </div>
                <div class="step">
                    <span>2Ô∏è‚É£</span>
                    <span>Entrega</span>
                </div>
                <div class="step">
                    <span>3Ô∏è‚É£</span>
                    <span>Pagamento</span>
                </div>
                <div class="step">
                    <span>‚úÖ</span>
                    <span>Confirma√ß√£o</span>
                </div>
            </div>
        </div>

        <div class="checkout-content">
            <div class="checkout-form">
                <!-- Dados Pessoais -->
                <div class="form-section">
                    <h3>üë§ Dados Pessoais</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="nome">Nome Completo*</label>
                            <input type="text" id="nome" required>
                        </div>
                        <div class="form-group">
                            <label for="cpf">CPF*</label>
                            <input type="text" id="cpf" placeholder="000.000.000-00" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">E-mail*</label>
                            <input type="email" id="email" required>
                        </div>
                        <div class="form-group">
                            <label for="telefone">Telefone*</label>
                            <input type="tel" id="telefone" placeholder="(00) 00000-0000" required>
                        </div>
                    </div>
                </div>

                <!-- Endere√ßo de Entrega -->
                <div class="form-section">
                    <h3>üìç Endere√ßo de Entrega</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="cep">CEP*</label>
                            <input type="text" id="cep" placeholder="00000-000" required>
                        </div>
                        <div class="form-group">
                            <label for="cidade">Cidade*</label>
                            <input type="text" id="cidade" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="endereco">Endere√ßo*</label>
                        <input type="text" id="endereco" placeholder="Rua, Avenida..." required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="numero">N√∫mero*</label>
                            <input type="text" id="numero" required>
                        </div>
                        <div class="form-group">
                            <label for="complemento">Complemento</label>
                            <input type="text" id="complemento" placeholder="Apt, Bloco, Casa...">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="bairro">Bairro*</label>
                        <input type="text" id="bairro" required>
                    </div>
                    <div class="form-group">
                        <label for="referencia">Ponto de Refer√™ncia</label>
                        <input type="text" id="referencia" placeholder="Ex: Pr√≥ximo ao mercado central">
                    </div>
                </div>

                <!-- Op√ß√µes de Entrega -->
                <div class="form-section">
                    <h3>üöö Op√ß√µes de Entrega</h3>
                    <div class="delivery-options">
                        <div class="delivery-option" onclick="selectDelivery('express')">
                            <input type="radio" name="delivery" value="express" id="express">
                            <label for="express">
                                <strong>üöÄ Entrega Express (2-4 horas)</strong><br>
                                <span style="color: #666;">R$ 12,90 - Receba hoje mesmo</span>
                            </label>
                        </div>
                        <div class="delivery-option selected" onclick="selectDelivery('normal')">
                            <input type="radio" name="delivery" value="normal" id="normal" checked>
                            <label for="normal">
                                <strong>üöö Entrega Normal (1-2 dias)</strong><br>
                                <span style="color: #666;">R$ 5,00 - Gr√°tis acima de R$ 50,00</span>
                            </label>
                        </div>
                        <div class="delivery-option" onclick="selectDelivery('scheduled')">
                            <input type="radio" name="delivery" value="scheduled" id="scheduled">
                            <label for="scheduled">
                                <strong>üìÖ Entrega Agendada (Escolha o dia)</strong><br>
                                <span style="color: #666;">R$ 7,90 - Escolha data e hor√°rio</span>
                            </label>
                        </div>
                    </div>
                    
                    <div id="schedule-options" style="display: none; margin-top: 20px;">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="delivery-date">Data da Entrega</label>
                                <input type="date" id="delivery-date">
                            </div>
                            <div class="form-group">
                                <label for="delivery-time">Hor√°rio Preferido</label>
                                <select id="delivery-time">
                                    <option value="">Selecione...</option>
                                    <option value="morning">Manh√£ (8h √†s 12h)</option>
                                    <option value="afternoon">Tarde (13h √†s 17h)</option>
                                    <option value="evening">Noite (18h √†s 20h)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Forma de Pagamento -->
                <div class="form-section">
                    <h3>üí≥ Forma de Pagamento</h3>
                    <div class="payment-methods">
                        <div class="payment-method selected" onclick="selectPayment('pix')">
                            <div class="payment-icon">üí≥</div>
                            <div>
                                <strong>PIX</strong><br>
                                <span style="color: #666;">Pagamento instant√¢neo - 5% de desconto</span>
                            </div>
                        </div>
                        <div class="payment-method" onclick="selectPayment('credit')">
                            <div class="payment-icon">üí≥</div>
                            <div>
                                <strong>Cart√£o de Cr√©dito</strong><br>
                                <span style="color: #666;">Parcelamento em at√© 12x</span>
                            </div>
                        </div>
                        <div class="payment-method" onclick="selectPayment('debit')">
                            <div class="payment-icon">üí≥</div>
                            <div>
                                <strong>Cart√£o de D√©bito</strong><br>
                                <span style="color: #666;">D√©bito √† vista</span>
                            </div>
                        </div>
                        <div class="payment-method" onclick="selectPayment('money')">
                            <div class="payment-icon">üíµ</div>
                            <div>
                                <strong>Dinheiro</strong><br>
                                <span style="color: #666;">Pagamento na entrega</span>
                            </div>
                        </div>
                    </div>

                    <!-- Op√ß√µes de Cart√£o -->
                    <div id="card-options" style="display: none; margin-top: 20px;">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="card-number">N√∫mero do Cart√£o</label>
                                <input type="text" id="card-number" placeholder="0000 0000 0000 0000">
                            </div>
                            <div class="form-group">
                                <label for="card-name">Nome no Cart√£o</label>
                                <input type="text" id="card-name" placeholder="Como est√° no cart√£o">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="card-expiry">Validade</label>
                                <input type="text" id="card-expiry" placeholder="MM/AA">
                            </div>
                            <div class="form-group">
                                <label for="card-cvv">CVV</label>
                                <input type="text" id="card-cvv" placeholder="000">
                            </div>
                        </div>
                        <div id="installments" style="display: none;">
                            <div class="form-group">
                                <label for="card-installments">Parcelas</label>
                                <select id="card-installments">
                                    <option value="1">1x sem juros</option>
                                    <option value="2">2x sem juros</option>
                                    <option value="3">3x sem juros</option>
                                    <option value="6">6x com juros</option>
                                    <option value="12">12x com juros</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Op√ß√£o Dinheiro -->
                    <div id="money-options" style="display: none; margin-top: 20px;">
                        <div class="form-group">
                            <label for="change-value">Troco para quanto? (Opcional)</label>
                            <input type="number" id="change-value" placeholder="Ex: 100.00" step="0.01">
                        </div>
                    </div>
                </div>

                <!-- Observa√ß√µes -->
                <div class="form-section">
                    <h3>üìù Observa√ß√µes</h3>
                    <div class="form-group">
                        <label for="observations">Observa√ß√µes do Pedido</label>
                        <textarea id="observations" rows="3" placeholder="Instru√ß√µes especiais, observa√ß√µes sobre produtos, etc."></textarea>
                    </div>
                </div>
            </div>

            <!-- Resumo do Pedido -->
            <div class="order-summary">
                <h3>üìã Resumo do Pedido</h3>
                <div id="order-items">
                    <!-- Itens ser√£o carregados aqui -->
                </div>

                <div class="total-section">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span id="subtotal">R$ 0,00</span>
                    </div>
                    <div class="total-row">
                        <span>Taxa de entrega:</span>
                        <span id="delivery-fee">R$ 5,00</span>
                    </div>
                    <div class="total-row" id="discount-row" style="display: none;">
                        <span>Desconto PIX (5%):</span>
                        <span id="discount" style="color: var(--success-color);">-R$ 0,00</span>
                    </div>
                    <div class="total-row total-final">
                        <span>Total:</span>
                        <span id="final-total">R$ 0,00</span>
                    </div>
                </div>

                <button class="place-order-btn" onclick="placeOrder()">
                    üõí Finalizar Pedido
                </button>
            </div>
        </div>
    </div>

    <!-- Modal PIX -->
    <div class="pix-modal" id="pix-modal">
        <div class="pix-content">
            <div class="pix-header">
                <h2>üí≥ Pagamento PIX</h2>
                <p><strong>Total: <span id="pix-total">R$ 0,00</span></strong></p>
            </div>

            <div class="qr-container">
                <div class="qr-code" id="qr-code"></div>
                <p><strong>Escaneie o QR Code com seu banco</strong></p>
            </div>

            <div class="pix-info">
                <p><strong>Ou copie a chave PIX:</strong></p>
                <div class="pix-key" id="pix-key">sua-chave@pix.com.br</div>
                <button class="copy-btn" onclick="copyPixKey()">üìã Copiar Chave PIX</button>
            </div>

            <div class="payment-instructions">
                <h4>üì± Como pagar:</h4>
                <ol>
                    <li>Abra o app do seu banco</li>
                    <li>Escolha a op√ß√£o PIX</li>
                    <li>Escaneie o QR Code ou cole a chave</li>
                    <li>Confirme o valor e efetue o pagamento</li>
                    <li>Guarde o comprovante</li>
                </ol>
                <p><strong>‚è±Ô∏è Voc√™ tem 15 minutos para efetuar o pagamento</strong></p>
            </div>

            <button class="confirm-payment-btn" onclick="confirmPixPayment()">
                ‚úÖ J√° efetuei o pagamento
            </button>
        </div>
    </div>

    <!-- Notifica√ß√£o -->
    <div class="notification" id="notification"></div>

    <script>
        // Configura√ß√£o PIX
        const PIX_CONFIG = {
            chavePix: "sua-chave@pix.com.br",
            nomeRecebedor: "SuperMercado Online",
            cidade: "Taiobeiras"
        };

        let currentStep = 1;
        let selectedDelivery = 'normal';
        let selectedPayment = 'pix';
        let orderData = {};

        // Carregar dados do carrinho (simulado)
        const mockCartData = [
            { id: 1, name: 'Ma√ß√£ Gala', price: 4.99, quantity: 2, emoji: 'üçé', unit: 'kg' },
            { id: 8, name: 'Tomate', price: 5.99, quantity: 1, emoji: 'üçÖ', unit: 'kg' },
            { id: 18, name: 'Leite Integral', price: 4.20, quantity: 3, emoji: 'ü•õ', unit: '1L' },
        ];

        // Fun√ß√£o para carregar itens do pedido
        function loadOrderItems() {
            const container = document.getElementById('order-items');
            container.innerHTML = '';

            mockCartData.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'summary-item';
                itemElement.innerHTML = `
                    <div class="item-details">
                        <div class="item-name">${item.emoji} ${item.name}</div>
                        <div class="item-quantity">${item.quantity} ${item.unit} √ó R$ ${item.price.toFixed(2)}</div>
                    </div>
                    <div class="item-price">R$ ${(item.price * item.quantity).toFixed(2)}</div>
                `;
                container.appendChild(itemElement);
            });

            updateTotals();
        }

        // Fun√ß√£o para atualizar totais
        function updateTotals() {
            const subtotal = mockCartData.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            let deliveryFee = 5.00;
            
            // Calcular taxa de entrega baseada na op√ß√£o selecionada
            if (selectedDelivery === 'express') {
                deliveryFee = 12.90;
            } else if (selectedDelivery === 'scheduled') {
                deliveryFee = 7.90;
            } else if (subtotal >= 50) {
                deliveryFee = 0;
            }

            // Desconto PIX
            let discount = 0;
            if (selectedPayment === 'pix') {
                discount = subtotal * 0.05;
                document.getElementById('discount-row').style.display = 'flex';
                document.getElementById('discount').textContent = `-R$ ${discount.toFixed(2)}`;
            } else {
                document.getElementById('discount-row').style.display = 'none';
            }

            const total = subtotal + deliveryFee - discount;

            document.getElementById('subtotal').textContent = `R$ ${subtotal.toFixed(2)}`;
            document.getElementById('delivery-fee').textContent = deliveryFee === 0 ? 'GR√ÅTIS' : `R$ ${deliveryFee.toFixed(2)}`;
            document.getElementById('final-total').textContent = `R$ ${total.toFixed(2)}`;
        }

        // Fun√ß√£o para selecionar op√ß√£o de entrega
        function selectDelivery(type) {
            selectedDelivery = type;
            
            // Atualizar visual
            document.querySelectorAll('.delivery-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Mostrar/ocultar op√ß√µes de agendamento
            const scheduleOptions = document.getElementById('schedule-options');
            if (type === 'scheduled') {
                scheduleOptions.style.display = 'block';
                // Definir data m√≠nima para amanh√£
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                document.getElementById('delivery-date').min = tomorrow.toISOString().split('T')[0];
            } else {
                scheduleOptions.style.display = 'none';
            }
            
            updateTotals();
        }

        // Fun√ß√£o para selecionar forma de pagamento
        function selectPayment(type) {
            selectedPayment = type;
            
            // Atualizar visual
            document.querySelectorAll('.payment-method').forEach(method => {
                method.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Mostrar/ocultar op√ß√µes espec√≠ficas
            document.getElementById('card-options').style.display = 
                (type === 'credit' || type === 'debit') ? 'block' : 'none';
            document.getElementById('installments').style.display = 
                type === 'credit' ? 'block' : 'none';
            document.getElementById('money-options').style.display = 
                type === 'money' ? 'block' : 'none';
            
            updateTotals();
        }

        // Validar formul√°rio
        function validateForm() {
            const requiredFields = [
                'nome', 'cpf', 'email', 'telefone',
                'cep', 'cidade', 'endereco', 'numero', 'bairro'
            ];

            for (let field of requiredFields) {
                const element = document.getElementById(field);
                if (!element.value.trim()) {
                    showNotification(`Por favor, preencha o campo ${element.previousElementSibling.textContent}`, 'error');
                    element.focus();
                    return false;
                }
            }

            // Valida√ß√µes espec√≠ficas para cart√£o
            if (selectedPayment === 'credit' || selectedPayment === 'debit') {
                const cardFields = ['card-number', 'card-name', 'card-expiry', 'card-cvv'];
                for (let field of cardFields) {
                    if (!document.getElementById(field).value.trim()) {
                        showNotification('Por favor, preencha todos os dados do cart√£o', 'error');
                        return false;
                    }
                }
            }

            // Valida√ß√£o para entrega agendada
            if (selectedDelivery === 'scheduled') {
                if (!document.getElementById('delivery-date').value || !document.getElementById('delivery-time').value) {
                    showNotification('Por favor, escolha data e hor√°rio para entrega agendada', 'error');
                    return false;
                }
            }

            return true;
        }

        // Fun√ß√£o para finalizar pedido
        function placeOrder() {
            if (!validateForm()) return;

            // Coletar dados do formul√°rio
            orderData = {
                customer: {
                    nome: document.getElementById('nome').value,
                    cpf: document.getElementById('cpf').value,
                    email: document.getElementById('email').value,
                    telefone: document.getElementById('telefone').value
                },
                address: {
                    cep: document.getElementById('cep').value,
                    cidade: document.getElementById('cidade').value,
                    endereco: document.getElementById('endereco').value,
                    numero: document.getElementById('numero').value,
                    complemento: document.getElementById('complemento').value,
                    bairro: document.getElementById('bairro').value,
                    referencia: document.getElementById('referencia').value
                },
                delivery: {
                    type: selectedDelivery,
                    date: document.getElementById('delivery-date').value,
                    time: document.getElementById('delivery-time').value
                },
                payment: {
                    method: selectedPayment,
                    changeFor: document.getElementById('change-value')?.value
                },
                observations: document.getElementById('observations').value,
                items: mockCartData,
                total: parseFloat(document.getElementById('final-total').textContent.replace('R$ ', ''))
            };

            if (selectedPayment === 'pix') {
                openPixModal();
            } else {
                processOrder();
            }
        }

        // Fun√ß√£o para abrir modal PIX
        function openPixModal() {
            const total = orderData.total;
            document.getElementById('pix-total').textContent = `R$ ${total.toFixed(2)}`;
            document.getElementById('pix-key').textContent = PIX_CONFIG.chavePix;
            
            generatePixQRCode(total);
            document.getElementById('pix-modal').style.display = 'block';
        }

        // Fun√ß√£o para gerar QR Code PIX
        function generatePixQRCode(valor) {
            const pixString = `${PIX_CONFIG.chavePix}|${valor.toFixed(2)}|${PIX_CONFIG.nomeRecebedor}|${PIX_CONFIG.cidade}`;
            const qrContainer = document.getElementById('qr-code');
            
            qrContainer.innerHTML = '';
            
            QRCode.toCanvas(qrContainer, pixString, {
                width: 220,
                height: 220,
                color: {
                    dark: '#000000',
                    light: '#FFFFFF'
                }
            }, function (error) {
                if (error) {
                    console.error('Erro ao gerar QR Code:', error);
                    qrContainer.innerHTML = '<p>Erro ao gerar QR Code</p>';
                }
            });
        }

        // Fun√ß√£o para copiar chave PIX
        function copyPixKey() {
            const pixKey = PIX_CONFIG.chavePix;
            navigator.clipboard.writeText(pixKey).then(() => {
                showNotification('Chave PIX copiada! üìã', 'success');
            }).catch(() => {
                // Fallback
                const textArea = document.createElement('textarea');
                textArea.value = pixKey;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('Chave PIX copiada! üìã', 'success');
            });
        }

        // Fun√ß√£o para confirmar pagamento PIX
        function confirmPixPayment() {
            document.getElementById('pix-modal').style.display = 'none';
            processOrder();
        }

        // Fun√ß√£o para processar pedido
        function processOrder() {
            // Simular processamento
            showNotification('Processando seu pedido...', 'success');
            
            setTimeout(() => {
                const orderNumber = Math.random().toString(36).substr(2, 9).toUpperCase();
                
                // Mostrar confirma√ß√£o
                alert(`üéâ Pedido realizado com sucesso!\n\nN√∫mero do pedido: ${orderNumber}\n\nVoc√™ receber√° um e-mail com os detalhes.\n\nObrigado por comprar conosco!`);
                
                // Redirecionar para p√°gina de confirma√ß√£o
                window.location.href = `pedidos.html?order=${orderNumber}`;
            }, 2000);
        }

        // Fun√ß√£o para mostrar notifica√ß√£o
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // M√°scaras para campos
        function applyMasks() {
            // CPF
            document.getElementById('cpf').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
                e.target.value = value;
            });

            // Telefone
            document.getElementById('telefone').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
                e.target.value = value;
            });

            // CEP
            document.getElementById('cep').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                value = value.replace(/(\d{5})(\d{3})/, '$1-$2');
                e.target.value = value;
            });

            // Cart√£o
            document.getElementById('card-number').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                value = value.replace(/(\d{4})(\d{4})(\d{4})(\d{4})/, '$1 $2 $3 $4');
                e.target.value = value;
            });

            document.getElementById('card-expiry').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                value = value.replace(/(\d{2})(\d{2})/, '$1/$2');
                e.target.value = value;
            });
        }

        // Inicializar p√°gina
        window.addEventListener('load', function() {
            loadOrderItems();
            applyMasks();
            
            // Configurar data m√≠nima para entrega
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('delivery-date').min = tomorrow.toISOString().split('T')[0];
        });

        // Fechar modal PIX clicando fora
        document.getElementById('pix-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });
    </script>
</body>
</html>